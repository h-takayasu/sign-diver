<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Sign Diverã®ãƒ—ãƒ¬ã‚¤å±¥æ­´ã€‚éå»ã®ã‚¹ã‚³ã‚¢ã€åˆ°é”æ·±åº¦ã€ç²å¾—ç§°å·ã‚’ç¢ºèªã§ãã¾ã™ã€‚">
  <meta name="robots" content="noindex">
  <title>ãƒ—ãƒ¬ã‚¤å±¥æ­´ - æŒ‡æ–‡å­—ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚²ãƒ¼ãƒ  Sign Diver</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', 'Arial', sans-serif;
      background: linear-gradient(135deg, #e0f7ff 0%, #b3e5fc 50%, #81d4fa 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 32px 16px 40px;
      gap: 20px;
      color: #1a237e;
      position: relative;
      overflow-x: hidden;
    }
    
    /* èƒŒæ™¯ã®æ³¡ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 80%, rgba(255,255,255,0.3) 3px, transparent 3px),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.25) 4px, transparent 4px),
        radial-gradient(circle at 40% 40%, rgba(255,255,255,0.3) 2px, transparent 2px),
        radial-gradient(circle at 60% 70%, rgba(255,255,255,0.25) 5px, transparent 5px);
      background-size: 200px 200px, 300px 300px, 250px 250px, 350px 350px;
      animation: bubbleFloat 25s ease-in-out infinite;
      pointer-events: none;
      z-index: 0;
    }
    
    @keyframes bubbleFloat {
      0%, 100% { transform: translate(0, 0); }
      25% { transform: translate(10px, -20px); }
      50% { transform: translate(-5px, -40px); }
      75% { transform: translate(15px, -30px); }
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .page-header {
      width: 100%;
      max-width: 860px;
      display: flex;
      align-items: center;
      gap: 16px;
      position: relative;
      z-index: 1;
    }

    .back-btn {
      background: rgba(255,255,255,0.8);
      border: 2px solid rgba(100,181,246,0.4);
      color: #1a237e;
      padding: 8px 18px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .back-btn:hover { background: rgba(255,255,255,1); border-color: #64b5f6; transform: translateY(-2px); }

    .page-title {
      font-size: 26px;
      font-weight: 700;
      letter-spacing: 3px;
      color: #1a237e;
      text-shadow: 2px 2px 0 rgba(100,181,246,0.3);
    }

    .clear-btn {
      margin-left: auto;
      background: rgba(239,83,80,0.15);
      border: 2px solid rgba(239,83,80,0.4);
      color: #c62828;
      padding: 8px 18px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
    }
    .clear-btn:hover { background: rgba(239,83,80,0.25); color: #b71c1c; }

    /* çµ±è¨ˆã‚µãƒãƒªãƒ¼ */
    .summary {
      width: 100%;
      max-width: 860px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      position: relative;
      z-index: 1;
    }

    .summary-card {
      background: rgba(255,255,255,0.9);
      border: 2px solid rgba(100,181,246,0.3);
      border-radius: 14px;
      padding: 16px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(100,181,246,0.2);
    }

    .summary-label {
      font-size: 11px;
      color: #0288d1;
      letter-spacing: 1px;
      margin-bottom: 6px;
      font-weight: 600;
    }

    .summary-value {
      font-size: 24px;
      font-weight: 700;
      color: #1a237e;
    }

    /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
    .filters {
      width: 100%;
      max-width: 860px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      position: relative;
      z-index: 1;
    }

    .filter-btn {
      background: rgba(255,255,255,0.7);
      border: 2px solid rgba(100,181,246,0.3);
      color: #1a237e;
      padding: 6px 16px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
    }

    .filter-btn.active, .filter-btn:hover {
      background: rgba(100,181,246,0.3);
      border-color: #64b5f6;
      color: #1a237e;
      transform: translateY(-2px);
    }

    /* å±¥æ­´ãƒªã‚¹ãƒˆ */
    .history-list {
      width: 100%;
      max-width: 860px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .history-card {
      background: rgba(255,255,255,0.85);
      border: 2px solid rgba(100,181,246,0.3);
      border-radius: 14px;
      padding: 16px 20px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 16px;
      align-items: center;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(100,181,246,0.15);
    }

    .history-card:hover {
      background: rgba(255,255,255,0.95);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(100,181,246,0.25);
    }

    /* æ·±åº¦ãƒãƒƒã‚¸ */
    .depth-badge {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      gap: 2px;
    }

    .depth-icon  { font-size: 22px; }
    .depth-label { font-size: 9px; letter-spacing: 0.5px; opacity: 0.85; font-weight: 600; }

    /* ã‚¹ãƒ†ãƒ¼ã‚¸åˆ¥ã‚«ãƒ©ãƒ¼ */
    .stage-0 { background: rgba(0,191,255,0.18); border: 1px solid rgba(0,191,255,0.3); }
    .stage-1 { background: rgba(0,153,204,0.18); border: 1px solid rgba(0,153,204,0.3); }
    .stage-2 { background: rgba(0,119,170,0.18); border: 1px solid rgba(0,119,170,0.3); }
    .stage-3 { background: rgba(0,85,136,0.2);   border: 1px solid rgba(0,85,136,0.35); }
    .stage-4 { background: rgba(0,51,102,0.22);  border: 1px solid rgba(0,51,102,0.4); }
    .stage-5 { background: rgba(0,31,68,0.25);   border: 1px solid rgba(79,172,254,0.2); }
    .stage-6 { background: rgba(0,14,34,0.3);    border: 1px solid rgba(79,172,254,0.15); }
    .stage-7 { background: rgba(0,5,17,0.35);    border: 1px solid rgba(100,100,180,0.2); }
    .stage-8 { background: rgba(10,0,21,0.4);    border: 1px solid rgba(160,80,255,0.25); }
    .stage-old { background: rgba(80,80,80,0.15); border: 1px solid rgba(150,150,150,0.2); }

    .card-depth.no-data {
      color: rgba(26,35,126,0.3);
      font-style: italic;
    }

    /* ä¸­å¤®ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ± */
    .card-info { min-width: 0; }

    .card-top {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .card-score {
      font-size: 22px;
      font-weight: 700;
      color: #0277bd;
    }

    .card-stage-name {
      font-size: 13px;
      font-weight: 600;
      padding: 2px 10px;
      border-radius: 50px;
      background: rgba(100,181,246,0.2);
      color: #1a237e;
    }

    .card-depth {
      font-size: 12px;
      color: #0288d1;
    }

    .card-stats {
      display: flex;
      gap: 16px;
      font-size: 13px;
      color: #0288d1;
      flex-wrap: wrap;
    }

    .card-stat span { color: #1a237e; font-weight: 600; }

    .diff-badge {
      display: inline-block;
      padding: 1px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 700;
    }
    .diff-easy   { background: rgba(76,175,80,0.25);  color: #388e3c; }
    .diff-medium { background: rgba(255,152,0,0.25);  color: #f57c00; }
    .diff-hard   { background: rgba(244,67,54,0.25);  color: #d32f2f; }

    .card-title-badge {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 700;
      background: rgba(206,147,216,0.25);
      color: #0277bd;
      border: 1px solid rgba(206,147,216,0.4);
    }

    .card-title-badge.old-title {
      background: rgba(26,35,126,0.1);
      color: rgba(26,35,126,0.4);
      border-color: rgba(26,35,126,0.2);
    }

    /* å³å´ï¼šæ—¥æ™‚ */
    .card-date {
      text-align: right;
      font-size: 12px;
      color: #0288d1;
      flex-shrink: 0;
    }

    /* ç©ºãƒ»èª­ã¿è¾¼ã¿ */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #0288d1;
      position: relative;
      z-index: 1;
    }
    .empty-state .empty-icon { font-size: 48px; margin-bottom: 16px; }
    .empty-state p { font-size: 15px; line-height: 1.7; }

    /* ãƒ•ãƒƒã‚¿ãƒ¼ */
    .site-footer { margin-top: auto; position: relative; z-index: 1; }
    .site-footer a {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: #0288d1;
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
      transition: color 0.2s;
    }
    .site-footer a:hover { color: #0277bd; }
    .footer-icon { font-size: 11px; color: #ef5350; }

    @media (max-width: 600px) {
      .summary { grid-template-columns: repeat(2, 1fr); }
      .history-card { grid-template-columns: auto 1fr; }
      .card-date { display: none; }
    }
  </style>
  <link rel="icon" type="image/png" sizes="32x32" href="./asset/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./asset/favicon-16.png">
  <link rel="apple-touch-icon" href="./asset/sign_diver_favicon_512.png">
</head>
<body>

  <div class="page-header">
    <button class="back-btn" onclick="location.href='index.html'">â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼</button>
    <h1 class="page-title">ğŸ“‹ ãƒ—ãƒ¬ã‚¤å±¥æ­´</h1>
    <button class="clear-btn" onclick="clearHistory()">ğŸ—‘ å±¥æ­´ã‚’å‰Šé™¤</button>
  </div>

  <!-- çµ±è¨ˆã‚µãƒãƒªãƒ¼ -->
  <div class="summary">
    <div class="summary-card">
      <div class="summary-label">TOTAL PLAYS</div>
      <div class="summary-value" id="statTotal">0</div>
    </div>
    <div class="summary-card">
      <div class="summary-label">BEST SCORE</div>
      <div class="summary-value" id="statBest">0</div>
    </div>
    <div class="summary-card">
      <div class="summary-label">MAX DEPTH</div>
      <div class="summary-value" id="statDepth">0m</div>
    </div>
    <div class="summary-card">
      <div class="summary-label">DEEPEST STAGE</div>
      <div class="summary-value" id="statStage" style="font-size:16px;">â€”</div>
    </div>
  </div>

  <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
  <div class="filters">
    <button class="filter-btn active" data-filter="all">ã™ã¹ã¦</button>
    <button class="filter-btn" data-filter="easy">æ˜“ã—ã„</button>
    <button class="filter-btn" data-filter="medium">æ™®é€š</button>
    <button class="filter-btn" data-filter="hard">é›£ã—ã„</button>
  </div>

  <!-- å±¥æ­´ãƒªã‚¹ãƒˆ -->
  <div class="history-list" id="historyList"></div>

  <footer class="site-footer">
    <div style="margin-bottom: 8px; text-align: center;">
      <a href="about_yubimoji.html" style="margin: 0 12px;">æŒ‡æ–‡å­—ã¨ã¯ï¼Ÿ</a>
      <span style="color: rgba(2,136,209,0.3);">|</span>
      <a href="about_signdiver.html" style="margin: 0 12px;">Sign Diverã¨ã¯ï¼Ÿ</a>
      <span style="color: rgba(2,136,209,0.3);">|</span>
      <a href="terms.html" style="margin: 0 12px;">åˆ©ç”¨è¦ç´„</a>
      <span style="color: rgba(2,136,209,0.3);">|</span>
      <a href="privacy.html" style="margin: 0 12px;">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
    </div>
    <a href="https://www.youtube.com/@Katsuo_Shuwa_Doga" target="_blank" rel="noopener noreferrer">
      <span class="footer-icon">â–¶</span>
      <span>@KatsuoShuwaDoga</span>
    </a>
  </footer>

  <script>
    // ã‚¹ãƒ†ãƒ¼ã‚¸å®šç¾©ï¼ˆtyping_game.htmlã¨åŒã˜ï¼‰
    const LEVELS = [
      { minChars:   0, depth:     0, name: 'æµ…ç€¬',     icon: 'ğŸ–ï¸',  stageClass: 'stage-0' },
      { minChars:   8, depth:    10, name: 'çŠç‘šç¤',   icon: 'ğŸª¸',  stageClass: 'stage-1' },
      { minChars:  18, depth:    30, name: 'æµ…æµ·',     icon: 'ğŸ ',  stageClass: 'stage-2' },
      { minChars:  32, depth:    80, name: 'æ½®ç›®',     icon: 'ğŸŒŠ',  stageClass: 'stage-3' },
      { minChars:  48, depth:   200, name: 'ä¸­å±¤',     icon: 'ğŸ™',  stageClass: 'stage-4' },
      { minChars:  68, depth:   500, name: 'è–„æš®å±¤',   icon: 'ğŸŒ‘',  stageClass: 'stage-5' },
      { minChars:  92, depth:  1000, name: 'æ·±æµ·',     icon: 'ğŸ¦‘',  stageClass: 'stage-6' },
      { minChars: 120, depth:  3000, name: 'è¶…æ·±æµ·',   icon: 'â¬›',  stageClass: 'stage-7' },
      { minChars: 155, depth: 11000, name: 'è¬ã®ç©ºé–“', icon: 'ğŸ‘¾',  stageClass: 'stage-8' },
    ];

    function getStage(totalChars) {
      let lv = 0;
      for (let i = 0; i < LEVELS.length; i++) {
        if ((totalChars || 0) >= LEVELS[i].minChars) lv = i;
      }
      return LEVELS[lv];
    }

    function getDepthM(totalChars) {
      const chars = totalChars || 0;
      const lv = getStageIndex(chars);
      const L = LEVELS[lv];
      const nextL = LEVELS[lv + 1];
      if (nextL) {
        const progress = (chars - L.minChars) / (nextL.minChars - L.minChars);
        return Math.round(L.depth + (nextL.depth - L.depth) * Math.min(1, progress));
      }
      return Math.round(L.depth + (chars - L.minChars) * 15);
    }

    function getStageIndex(chars) {
      let lv = 0;
      for (let i = 0; i < LEVELS.length; i++) {
        if ((chars || 0) >= LEVELS[i].minChars) lv = i;
      }
      return lv;
    }

    function formatDate(iso) {
      const d = new Date(iso);
      const y = d.getFullYear();
      const mo = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      const h = String(d.getHours()).padStart(2, '0');
      const mi = String(d.getMinutes()).padStart(2, '0');
      return `${y}/${mo}/${day}<br>${h}:${mi}`;
    }

    function diffLabel(d) {
      if (d === 'easy')   return '<span class="diff-badge diff-easy">æ˜“ã—ã„</span>';
      if (d === 'medium') return '<span class="diff-badge diff-medium">æ™®é€š</span>';
      if (d === 'hard')   return '<span class="diff-badge diff-hard">é›£ã—ã„</span>';
      return '';
    }

    let allScores = [];
    let currentFilter = 'all';

    function loadAndRender() {
      allScores = JSON.parse(localStorage.getItem('allScores') || '[]')
                    .reverse(); // æ–°ã—ã„é †

      // ã‚µãƒãƒªãƒ¼è¨ˆç®—
      if (allScores.length > 0) {
        const bestScore = Math.max(...allScores.map(s => s.score || 0));
        const maxChars  = Math.max(...allScores.map(s => s.totalChars || 0));
        const deepStage = getStage(maxChars);
        const maxDepth  = getDepthM(maxChars);

        document.getElementById('statTotal').textContent = allScores.length;
        document.getElementById('statBest').textContent  = bestScore.toLocaleString();
        document.getElementById('statDepth').textContent = maxDepth.toLocaleString() + 'm';
        document.getElementById('statStage').textContent = deepStage.icon + ' ' + deepStage.name;
      }

      renderList();
    }

    function renderList() {
      const list = document.getElementById('historyList');
      const filtered = currentFilter === 'all'
        ? allScores
        : allScores.filter(s => s.difficulty === currentFilter);

      if (filtered.length === 0) {
        list.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">ğŸŒŠ</div>
            <p>ã¾ã å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚<br>ã‚²ãƒ¼ãƒ ã‚’ãƒ—ãƒ¬ã‚¤ã—ã¦æ·±æµ·ã‚’ç›®æŒ‡ãã†ï¼</p>
          </div>`;
        return;
      }

      list.innerHTML = filtered.map((s, i) => {
        const stage   = s.totalChars != null ? getStage(s.totalChars) : null;
        const depth   = s.totalChars != null ? getDepthM(s.totalChars) : null;
        const chars   = s.totalChars != null ? s.totalChars : null;
        const speed   = s.speed || '0.00';
        const cleared = s.cleared || 0;
        const tl      = s.timeLimit ? s.timeLimit + 'ç§’' : 'â€”';

        const badgeHtml = stage
          ? `<div class="depth-badge ${stage.stageClass}">
               <div class="depth-icon">${stage.icon}</div>
               <div class="depth-label">${stage.name}</div>
             </div>`
          : `<div class="depth-badge stage-old">
               <div class="depth-icon">ğŸ“¦</div>
               <div class="depth-label">æ—§ãƒ‡ãƒ¼ã‚¿</div>
             </div>`;

        const depthHtml = depth != null
          ? `<span class="card-depth">â–¼ ${depth.toLocaleString()}m</span>`
          : `<span class="card-depth no-data">æ·±åº¦ãƒ‡ãƒ¼ã‚¿ãªã—</span>`;

        const charsHtml = chars != null ? chars : '<span style="opacity:0.4">â€”</span>';

        const titleHtml = s.titleEmoji
          ? `<span class="card-title-badge">${s.titleEmoji} ${s.titleText}</span>`
          : `<span class="card-title-badge old-title">â€”</span>`;

        return `
          <div class="history-card">
            ${badgeHtml}
            <div class="card-info">
              <div class="card-top">
                <span class="card-score">${(s.score || 0).toLocaleString()}ç‚¹</span>
                ${diffLabel(s.difficulty)}
                ${titleHtml}
                ${depthHtml}
              </div>
              <div class="card-stats">
                <span>ã‚¯ãƒªã‚¢: <span>${cleared}å•</span></span>
                <span>æ–‡å­—æ•°: <span>${charsHtml}</span></span>
                <span>é€Ÿåº¦: <span>${speed} æ–‡å­—/ç§’</span></span>
                <span>åˆ¶é™: <span>${tl}</span></span>
              </div>
            </div>
            <div class="card-date">${formatDate(s.date)}</div>
          </div>`;
      }).join('');
    }

    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.filter;
        renderList();
      });
    });

    // å±¥æ­´å‰Šé™¤
    function clearHistory() {
      if (!confirm('å±¥æ­´ã‚’ã™ã¹ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
      localStorage.removeItem('allScores');
      location.reload();
    }

    loadAndRender();
  </script>
</body>
</html>
